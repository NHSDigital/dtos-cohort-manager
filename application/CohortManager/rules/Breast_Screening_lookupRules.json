[
  {
    "WorkflowName": "Common",
    "Rules": [
      {
        "RuleName": "36.ValidatePrimaryCareProvider.NonFatal",
        "Expression": "dbLookup.ValidatePrimaryCareProvider(newParticipant.PrimaryCareProvider)",
        "Actions": {
          "OnFailure": {
            "Name": "OutputExpression",
            "Context": {
              "Expression": "\"Invalid primary care provider GP practice code\""
            }
          }
        }
      }
    ]
  },
  {
    "WorkflowName": "New",
    "Rules": [
      {
        "RuleName": "47.ParticipantMustNotExist.Fatal",
        "Expression": "string.IsNullOrWhiteSpace(existingParticipant.NhsNumber)"
      }
    ]
  },
  {
    "WorkflowName": "Amended",
    "Rules": [
      {
        "RuleName": "22.ParticipantMustExist.Fatal",
        "Expression": "!string.IsNullOrWhiteSpace(existingParticipant.NhsNumber)"
      },
      {
        "RuleName": "35.Demographics.NonFatal",
        "Expression": "(newParticipant.FamilyName == existingParticipant.FamilyName AND newParticipant.Gender == existingParticipant.Gender) OR (newParticipant.FamilyName == existingParticipant.FamilyName AND newParticipant.DateOfBirth == existingParticipant.DateOfBirth) OR (newParticipant.Gender == existingParticipant.Gender AND newParticipant.DateOfBirth == existingParticipant.DateOfBirth)"
      }
    ]
  },
  {
    "WorkflowName": "Removed",
    "Rules": [
      {
        "RuleName": "22.ParticipantMustExist.Fatal",
        "Expression": "!string.IsNullOrWhiteSpace(existingParticipant.NhsNumber)"
      }
    ]
  }
]
